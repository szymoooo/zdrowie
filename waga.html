<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Twoje zdrowie</title>
<style>
  /* Reset i podstawowe style */
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    background-color: #f5f7fa;
    color: #333;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    font-size: 16px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }

  h1, h2, h3, h4 {
    color: #222;
    margin-bottom: 20px;
    text-align: center;
    width: 100%;
  }

  /* Style dla kontenerÃ³w */
  #content {
    max-width: 1200px;
    width: 100%;
    margin: 20px auto;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
  }

  #yellowA, #yellowB, #mealContainer {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    color: #222;
    position: relative;
  }

  #mealContainer, #yellowA {
    padding-bottom: 100px;
  }

  #rightContainer {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    color: #222;
    grid-column: 1 / -1;
    margin-top: 20px;
  }

  /* Style dla modali */
  .modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 20px;
  }

  .modal-content {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    max-width: 500px;
    width: 100%;
    position: relative;
    max-height: 90vh;
    overflow-y: auto;
  }

  .close {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 24px;
    cursor: pointer;
    color: #777;
  }

  /* Style dla formularzy */
  .form-group {
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #444;
  }

  input, select, textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 16px;
    transition: all 0.3s;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: #4a90e2;
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
  }

  button {
    background: #4a90e2;
    color: white;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    padding: 12px 20px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 16px;
    width: 100%;
    margin-top: 10px;
  }

  button:hover {
    background: #357abd;
    transform: translateY(-2px);
  }

  /* Style dla danych uÅ¼ytkownika */
  .user-data-item {
    margin-bottom: 15px;
    padding-bottom: 12px;
    border-bottom: 1px solid #f0f0f0;
  }

  .user-data-item:last-child {
    border-bottom: none;
    margin-bottom: 25px;
    padding-bottom: 0;
  }

  .user-data-label {
    font-weight: 600;
    color: #666;
    display: inline-block;
    width: 140px;
  }

  .user-data-value {
    font-size: 16px;
    color: #222;
  }

  /* Style dla podsumowania */
  .summary-item {
    margin-bottom: 15px;
    padding: 12px 0;
    border-bottom: 1px solid #f0f0f0;
  }

  .summary-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .summary-label {
    font-weight: 600;
    color: #666;
    display: inline-block;
    width: 140px;
  }

  .summary-value {
    font-size: 16px;
    color: #222;
  }

  /* Kolory dla BMI */
  .bmi-normal { color: #27ae60; }
  .bmi-underweight { color: #f39c12; }
  .bmi-overweight { color: #e67e22; }
  .bmi-obesity1 { color: #d35400; }
  .bmi-obesity2 { color: #c0392b; }
  .bmi-obesity3 { color: #7f8c8d; }

  /* Style dla listy posiÅ‚kÃ³w */
  .meal-list {
    max-height: 300px;
    overflow-y: auto;
    margin-top: 15px;
    margin-bottom: 15px;
  }

  .meal-item {
    padding: 10px;
    border-bottom: 1px solid #eee;
    margin-bottom: 15px;
  }

  .meal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f5f5f5;
  }

  .meal-name {
    font-weight: 600;
    font-size: 16px;
  }

  .meal-calories-value {
    color: #27ae60;
    font-weight: bold;
    margin-left: 15px;
    margin-right: 15px;
  }

  .ingredient-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding: 8px 0;
  }

  .ingredient-item:last-child {
    margin-bottom: 20px;
  }

  .ingredient-name {
    flex: 1;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    padding-right: 15px;
  }

  .ingredient-calories {
    flex-shrink: 0;
    width: 80px;
    text-align: right;
    margin-right: 10px;
  }

  /* Nawigacja pomiarÃ³w i posiÅ‚kÃ³w */
  .measurement-dots, .meal-dots {
    display: flex;
    justify-content: center;
    margin: 20px 0;
    flex-wrap: wrap;
    position: absolute;
    bottom: 80px;
    left: 0;
    right: 0;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ddd;
    margin: 5px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .dot:hover {
    transform: scale(1.2);
  }

  .dot.active {
    background: #4a90e2;
    transform: scale(1.2);
  }

  /* Przyciski na dole kontenera */
  .container-footer {
    position: absolute;
    bottom: 20px;
    left: 25px;
    right: 25px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  /* Style dla autouzupeÅ‚niania */
  .autocomplete {
    position: relative;
    display: inline-block;
    width: 100%;
  }

  .autocomplete-items {
    position: absolute;
    border: 1px solid #d4d4d4;
    border-bottom: none;
    border-top: none;
    z-index: 99;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
  }

  .autocomplete-items div {
    padding: 10px;
    cursor: pointer;
    background-color: #fff;
    border-bottom: 1px solid #d4d4d4;
  }

  .autocomplete-items div:hover {
    background-color: #e9e9e9;
  }

  /* Style dla formularza skÅ‚adnikÃ³w */
  .ingredient-inputs {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    flex-wrap: wrap;
    align-items: center;
  }

  .ingredient-inputs input[type="text"],
  .ingredient-inputs input[type="number"] {
    flex: 2;
    min-width: 120px;
  }

  .ingredient-inputs select {
    flex: 1;
    min-width: 80px;
  }

  .ingredient-inputs button {
    flex: 0 0 auto;
    width: auto;
    padding: 12px;
  }

  /* Style dla bÅ‚Ä™dÃ³w walidacji */
  .error-message {
    color: #e74c3c;
    font-size: 0.9em;
    margin-top: 5px;
    display: none;
  }

  .has-error {
    border-color: #e74c3c !important;
  }

  /* Style dla listy skÅ‚adnikÃ³w */
  .ingredient-list {
    margin-bottom: 15px;
  }

  .remove-ingredient-btn {
    background: #e74c3c;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 4px 8px;
    cursor: pointer;
    width: 30px;
    text-align: center;
    margin-left: 5px;
    transition: all 0.2s;
  }

  .remove-ingredient-btn:hover {
    background: #c0392b;
  }

  /* Style dla tabeli */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
  }

  th {
    background-color: #f8f9fa;
    font-weight: 600;
  }

  .hydration-info {
    font-size: 0.9em;
    line-height: 1.4;
  }

  /* Dymek informacyjny z zaleceniami */
.activity-tooltip {
  position: relative;
  display: inline-block;
  width: 100%;
  margin-top: 10px;
}

.activity-content {
  display: block;
  padding: 12px;
  border-radius: 8px;
  margin-top: 5px;
  min-width: 250px;
  max-width: 300px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  border: 1px solid rgba(0,0,0,0.1);
  text-align: center;
  margin: 0 auto;
  /* 80% przejrzystoÅ›ci (20% krycia) */
  opacity: 1;
  /* PÅ‚ynne przejÅ›cie przy najechaniu */
  transition: opacity 0.3s ease;
}

/* Efekt przy najechaniu - zwiÄ™kszenie widocznoÅ›ci */
.activity-content:hover {
  opacity: 1;
}

.activity-item {
  padding: 6px 0;
  text-align: center;
  list-style-type: none;
  font-size: 0.9em;
}

/* Kolory tÅ‚a dopasowane do BMI z przejrzystoÅ›ciÄ… */
.activity-content.bmi-underweight { 
  background-color: rgba(243, 156, 18, 0.8); /* pomaraÅ„czowy */
  color: white;
}
.activity-content.bmi-normal { 
  background-color: rgba(39, 174, 96, 0.8); /* zielony */
  color: white;
}
.activity-content.bmi-overweight { 
  background-color: rgba(230, 126, 34, 0.8); /* ciemny pomaraÅ„cz */
  color: white;
}
.activity-content.bmi-obesity1 { 
  background-color: rgba(211, 84, 0, 0.8); /* czerwonopomaraÅ„czowy */
  color: white;
}
.activity-content.bmi-obesity2 { 
  background-color: rgba(192, 57, 43, 0.8); /* czerwony */
  color: white;
}
.activity-content.bmi-obesity3 { 
  background-color: rgba(127, 140, 141, 0.8); /* szary */
  color: white;
}
  /* ResponsywnoÅ›Ä‡ */
  @media(max-width: 900px) {
    body {
      font-size: 14px;
      padding: 15px;
    }

    #content {
      grid-template-columns: 1fr;
    }
    
    #yellowA, #yellowB, #mealContainer, #rightContainer {
      padding: 20px;
      padding-bottom: 90px;
    }
    
    .modal-content {
      padding: 20px;
    }

    input, select, textarea {
      padding: 10px;
      font-size: 14px;
    }

    button {
      padding: 10px 15px;
      font-size: 14px;
    }

    #rightContainer {
      overflow-x: auto;
    }

    table {
      font-size: 13px;
    }

    .container-footer {
      bottom: 15px;
      left: 20px;
      right: 20px;
    }

    .measurement-dots, .meal-dots {
      bottom: 70px;
    }

    /* USUWAMY POGRUBIENIA */
    .user-data-label,
    .summary-label,
    .meal-name,
    label {
      font-weight: normal;
    }

    /* MNIEJSZE CZCIONKI */
    .user-data-label,
    .summary-label {
      width: 120px;
      font-size: 13px;
    }

    .user-data-value,
    .summary-value {
      font-size: 14px;
    }

    .meal-name,
    .ingredient-name {
      font-size: 14px;
    }

    .meal-calories-value,
    .ingredient-calories {
      font-size: 13px;
    }
  }
</style>

<body>

<!-- Modal poczÄ…tkowy -->
<div id="initialModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('initialModal').style.display='none'">&times;</span>
    <h2>WprowadÅº swoje dane</h2>
    <form id="initialForm">
      <div class="form-group">
        <label for="name">ImiÄ™:</label>
        <input type="text" id="name" name="name" required />
      </div>
      
      <div class="form-group">
        <label for="age">Wiek (lata):</label>
        <input type="number" id="age" name="age" min="1" max="120" required />
      </div>
      
      <div class="form-group">
        <label for="height">Wzrost (cm):</label>
        <input type="number" id="height" name="height" min="50" max="250" required />
      </div>
      
      <div class="form-group">
        <label for="targetWeight">Waga docelowa (kg):</label>
        <input type="number" id="targetWeight" name="targetWeight" min="20" max="300" required />
      </div>
      
      <button type="submit">Zapisz dane podstawowe</button>
    </form>
  </div>
</div>

<!-- Modal pomiarÃ³w -->
<div id="measurementModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('measurementModal').style.display='none'">&times;</span>
    <h2>Dodaj nowy pomiar</h2>
    <form id="measurementForm">
      <div class="form-group">
        <label for="measurementDate">Data pomiaru:</label>
        <input type="date" id="measurementDate" name="measurementDate" required />
      </div>
      
      <div class="form-group">
        <label for="currentWeight">Waga aktualna (kg):</label>
        <input type="number" id="currentWeight" name="currentWeight" min="20" max="300" step="0.1" required />
      </div>
      
      <div class="form-group">
        <label for="waist">ObwÃ³d pasa (cm):</label>
        <input type="number" id="waist" name="waist" min="30" max="200" step="1" />
      </div>
      
      <div class="form-group">
        <label for="wrist">ObwÃ³d nadgarstka (cm):</label>
        <input type="number" id="wrist" name="wrist" min="10" max="40" step="1" />
      </div>
      
      <div class="form-group">
        <label for="thigh">ObwÃ³d uda (cm):</label>
        <input type="number" id="thigh" name="thigh" min="20" max="100" step="1" />
      </div>
      
      <button type="submit">Zapisz pomiar</button>
    </form>
  </div>
</div>

<!-- Modal posiÅ‚kÃ³w -->
<div id="mealModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('mealModal').style.display='none'">&times;</span>
    <h2>Dodaj nowy posiÅ‚ek</h2>
    <form id="mealForm">
      <div class="form-group">
        <label for="mealName">Nazwa posiÅ‚ku:</label>
        <input type="text" id="mealName" name="mealName" />
        <div class="error-message" id="mealNameError"></div>
      </div>
      
      <div class="form-group">
        <label for="mealType">Typ posiÅ‚ku:</label>
        <select id="mealType" name="mealType">
          <option value="">-- Wybierz --</option>
          <option value="breakfast">Åšniadanie</option>
          <option value="second_breakfast">II Åšniadanie</option>
          <option value="lunch">Obiad</option>
          <option value="snack">Podwieczorek</option>
          <option value="dinner">Kolacja</option>
        </select>
        <div class="error-message" id="mealTypeError"></div>
      </div>
      
      <div class="form-group">
        <label>SkÅ‚adniki:</label>
        <div class="ingredient-list" id="ingredientList">
          <!-- Tu bÄ™dÄ… dodawane skÅ‚adniki -->
        </div>
        <div class="error-message" id="ingredientsError"></div>
        
        <div class="ingredient-inputs">
          <div class="autocomplete" style="flex: 3;">
            <input type="text" id="newIngredientName" placeholder="Nazwa skÅ‚adnika" class="ingredient-name">
            <div id="autocompleteList" class="autocomplete-items"></div>
          </div>
          <input type="number" id="newIngredientAmount" placeholder="IloÅ›Ä‡" min="0" step="0.1" class="ingredient-amount" style="flex: 1;">
          <select id="newIngredientUnit" class="ingredient-unit" style="flex: 1;">
            <option value="szt">szt.</option>
            <option value="g">g</option>
            <option value="kg">kg</option>
            <option value="ml">ml</option>
          </select>
          <button type="button" class="add-ingredient-btn" id="addIngredientBtn" style="flex: 0 0 auto; width: auto;">+</button>
        </div>
      </div>
      
      <div class="meal-calories" id="mealCaloriesDisplay">
        Suma kalorii: 0 kcal
      </div>
      
      <button type="submit">Dodaj posiÅ‚ek</button>
    </form>
  </div>
</div>

<h1>Twoje zdrowe Å¼ycie</h1>

<div id="content">
  <div id="yellowA">
    <h3>Dane uÅ¼ytkownika</h3>
    <div id="userData"></div>
    <div class="measurement-dots" id="measurementDots"></div>
    <div class="container-footer">
      <button id="addMeasurementBtn">Dodaj nowy pomiar</button>
    </div>
  </div>
  <div id="yellowB">
    <h3>Podsumowanie</h3>
    <div id="summaryData"></div>

  </div>
  <div id="mealContainer">

    <h3>JadÅ‚ospis</h3>
    <div class="meal-list" id="mealList"></div>
    <div class="meal-dots" id="mealDots"></div>
    <div class="container-footer">
      <button id="addMealBtn">Dodaj posiÅ‚ek</button>
    </div>
  </div>
  <div id="rightContainer">
    <h3>Plan tygodniowy (najbliÅ¼sze 4 tygodnie)</h3>
    <table style="width:100%; border-collapse: collapse;">
      <thead>
        <tr style="background-color: #f8f9fa;">
          <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">TydzieÅ„</th>
          <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">Waga (kg)</th>
          <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">BMI</th>
          <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">Zalecane aktywnoÅ›ci</th>
          <th style="padding: 10px; text-align: left; border-bottom: 1px solid #ddd;">Nawodnienie</th>
        </tr>
      </thead>
      <tbody id="weeklyPlanBody">
        <!-- Tu bÄ™dÄ… generowane wiersze z planem tygodniowym -->
      </tbody>
    </table>
  </div>
</div>

<script>
  // Rozbudowana baza produktÃ³w z emoji
  const ingredientDatabase = {
    // MiÄ™so i drÃ³b ğŸ¥©
    'woÅ‚owina (chuda)': { kcalPerUnit: 250, defaultUnit: '100g', emoji: 'ğŸ¥©' },
    'woÅ‚owina (tÅ‚usta)': { kcalPerUnit: 290, defaultUnit: '100g', emoji: 'ğŸ¥©' },
    'stek z antrykotu': { kcalPerUnit: 271, defaultUnit: '100g', emoji: 'ğŸ¥©' },
    'mielona woÅ‚owina 80/20': { kcalPerUnit: 290, defaultUnit: '100g', emoji: 'ğŸ¥©' },
    'mielona woÅ‚owina 90/10': { kcalPerUnit: 217, defaultUnit: '100g', emoji: 'ğŸ¥©' },
    'szynka wieprzowa': { kcalPerUnit: 196, defaultUnit: '100g', emoji: 'ğŸ–' },
    'boczek': { kcalPerUnit: 541, defaultUnit: 'g', emoji: 'ğŸ¥“' },
    'schab wieprzowy': { kcalPerUnit: 242, defaultUnit: '100g', emoji: 'ğŸ–' },
    'kurczak (pierÅ›)': { kcalPerUnit: 165, defaultUnit: '100g', emoji: 'ğŸ—' },
    'kurczak (udo)': { kcalPerUnit: 209, defaultUnit: '100g', emoji: 'ğŸ—' },
    'indyk (pierÅ›)': { kcalPerUnit: 135, defaultUnit: '100g', emoji: 'ğŸ¦ƒ' },
    'indyk (udo)': { kcalPerUnit: 175, defaultUnit: '100g', emoji: 'ğŸ¦ƒ' },
    'kaczka': { kcalPerUnit: 337, defaultUnit: '100g', emoji: 'ğŸ¦†' },
    'gÄ™Å›': { kcalPerUnit: 371, defaultUnit: '100g', emoji: 'ğŸ¦¢' },
    'wÄ…trÃ³bka wieprzowa': { kcalPerUnit: 134, defaultUnit: '100g', emoji: 'ğŸ§†' },
    'wÄ…trÃ³bka woÅ‚owa': { kcalPerUnit: 135, defaultUnit: '100g', emoji: 'ğŸ§†' },
    'wÄ…trÃ³bka drobiowa': { kcalPerUnit: 116, defaultUnit: '100g', emoji: 'ğŸ§†' },
    'kieÅ‚basa': { kcalPerUnit: 300, defaultUnit: '100g', emoji: 'ğŸŒ­' },
    
    // Ryby i owoce morza ğŸŸ
    'Å‚osoÅ›': { kcalPerUnit: 208, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'makrela': { kcalPerUnit: 262, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'sardynki': { kcalPerUnit: 208, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'tuÅ„czyk (Å›wieÅ¼y)': { kcalPerUnit: 144, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'tuÅ„czyk (w oleju)': { kcalPerUnit: 198, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'dorsz': { kcalPerUnit: 82, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'halibut': { kcalPerUnit: 105, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'pstrÄ…g': { kcalPerUnit: 148, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'Å›ledÅº': { kcalPerUnit: 210, defaultUnit: '100g', emoji: 'ğŸŸ' },
    'oÅ›miornica': { kcalPerUnit: 82, defaultUnit: '100g', emoji: 'ğŸ™' },
    'krewetki': { kcalPerUnit: 99, defaultUnit: '100g', emoji: 'ğŸ¦' },
    'maÅ‚Å¼e': { kcalPerUnit: 86, defaultUnit: '100g', emoji: 'ğŸ¦ª' },
    'homar': { kcalPerUnit: 89, defaultUnit: '100g', emoji: 'ğŸ¦' },
    'krab': { kcalPerUnit: 97, defaultUnit: '100g', emoji: 'ğŸ¦€' },
    
    // Warzywa ğŸ¥¦
    'brokuÅ‚y': { kcalPerUnit: 35, defaultUnit: '100g', emoji: 'ğŸ¥¦' },
    'kalafior': { kcalPerUnit: 25, defaultUnit: '100g', emoji: 'ğŸ¥¦' },
    'cukinia': { kcalPerUnit: 17, defaultUnit: '100g', emoji: 'ğŸ¥’' },
    'ogÃ³rek': { kcalPerUnit: 15, defaultUnit: '100g', emoji: 'ğŸ¥’' },
    'szpinak': { kcalPerUnit: 23, defaultUnit: '100g', emoji: 'ğŸƒ' },
    'kapusta': { kcalPerUnit: 25, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'jarmuÅ¼': { kcalPerUnit: 49, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'rukola': { kcalPerUnit: 25, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'saÅ‚ata': { kcalPerUnit: 15, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'papryka zielona': { kcalPerUnit: 20, defaultUnit: '100g', emoji: 'ğŸ«‘' },
    'papryka czerwona': { kcalPerUnit: 31, defaultUnit: '100g', emoji: 'ğŸ«‘' },
    'pieczarki': { kcalPerUnit: 22, defaultUnit: '100g', emoji: 'ğŸ„' },
    'rzodkiewka': { kcalPerUnit: 16, defaultUnit: '100g', emoji: 'ğŸŒ¶ï¸' },
    'bakÅ‚aÅ¼an': { kcalPerUnit: 25, defaultUnit: '100g', emoji: 'ğŸ†' },
    'seler naciowy': { kcalPerUnit: 16, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'fasolka szparagowa': { kcalPerUnit: 31, defaultUnit: '100g', emoji: 'ğŸ«›' },
    'por': { kcalPerUnit: 31, defaultUnit: '100g', emoji: 'ğŸ§…' },
    'cebula': { kcalPerUnit: 40, defaultUnit: '100g', emoji: 'ğŸ§…' },
    'czosnek': { kcalPerUnit: 143, defaultUnit: '100g', emoji: 'ğŸ§„' },
    'kalarepa': { kcalPerUnit: 27, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    
    // Jaja i nabiaÅ‚ ğŸ¥šğŸ§€
    'jajko kurze': { kcalPerUnit: 143, defaultUnit: 'szt', emoji: 'ğŸ¥š' },
    'jajka': { kcalPerUnit: 143, defaultUnit: 'szt', emoji: 'ğŸ¥š' },
    'jaja przepiÃ³rcze': { kcalPerUnit: 158, defaultUnit: 'szt', emoji: 'ğŸ¥š' },
    'ser Å¼Ã³Å‚ty': { kcalPerUnit: 356, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'ser cheddar': { kcalPerUnit: 403, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'ser pleÅ›niowy': { kcalPerUnit: 350, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'ser mozzarella': { kcalPerUnit: 280, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'twarÃ³g tÅ‚usty': { kcalPerUnit: 170, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'twarÃ³g pÃ³Å‚tÅ‚usty': { kcalPerUnit: 133, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'twarÃ³g chudy': { kcalPerUnit: 99, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'jogurt grecki': { kcalPerUnit: 120, defaultUnit: '100g', emoji: 'ğŸ¥›' },
    'masÅ‚o': { kcalPerUnit: 717, defaultUnit: '100g', emoji: 'ğŸ§ˆ' },
    'masÅ‚o klarowane': { kcalPerUnit: 900, defaultUnit: '100g', emoji: 'ğŸ§ˆ' },
    'Å›mietana 30%': { kcalPerUnit: 292, defaultUnit: '100g', emoji: 'ğŸ¥›' },
    'Å›mietana 36%': { kcalPerUnit: 340, defaultUnit: '100g', emoji: 'ğŸ¥›' },
    'ser mascarpone': { kcalPerUnit: 435, defaultUnit: '100g', emoji: 'ğŸ§€' },
    'feta': { kcalPerUnit: 264, defaultUnit: '100g', emoji: 'ğŸ§€' },
    
    // TÅ‚uszcze, oleje, orzechy ğŸ¥‘ğŸŒ°
    'oliwa z oliwek': { kcalPerUnit: 884, defaultUnit: '100ml', emoji: 'ğŸ«’' },
    'olej kokosowy': { kcalPerUnit: 862, defaultUnit: '100ml', emoji: 'ğŸ¥¥' },
    'smalec': { kcalPerUnit: 898, defaultUnit: '100g', emoji: 'ğŸ¥“' },
    'masÅ‚o orzechowe': { kcalPerUnit: 588, defaultUnit: '100g', emoji: 'ğŸ¥œ' },
    'awokado': { kcalPerUnit: 160, defaultUnit: '100g', emoji: 'ğŸ¥‘' },
    'migdaÅ‚y': { kcalPerUnit: 579, defaultUnit: '100g', emoji: 'ğŸŒ°' },
    'orzechy wÅ‚oskie': { kcalPerUnit: 654, defaultUnit: '100g', emoji: 'ğŸŒ°' },
    'orzechy laskowe': { kcalPerUnit: 628, defaultUnit: '100g', emoji: 'ğŸŒ°' },
    'nerkowce': { kcalPerUnit: 553, defaultUnit: '100g', emoji: 'ğŸŒ°' },
    'pistacje': { kcalPerUnit: 562, defaultUnit: '100g', emoji: 'ğŸŒ°' },
    'pestki dyni': { kcalPerUnit: 559, defaultUnit: '100g', emoji: 'ğŸƒ' },
    'pestki sÅ‚onecznika': { kcalPerUnit: 584, defaultUnit: '100g', emoji: 'ğŸŒ»' },
    
    // Inne
    'mÄ…ka kokosowa': { kcalPerUnit: 443, defaultUnit: '100g', emoji: 'ğŸ¥¥' },
    'kakao': { kcalPerUnit: 228, defaultUnit: '100g', emoji: 'ğŸ«' },
    'czekolada gorzka': { kcalPerUnit: 600, defaultUnit: '100g', emoji: 'ğŸ«' },
    'kiszona kapusta': { kcalPerUnit: 19, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'ogÃ³rki kiszone': { kcalPerUnit: 11, defaultUnit: '100g', emoji: 'ğŸ¥’' },
    'kimchi': { kcalPerUnit: 30, defaultUnit: '100g', emoji: 'ğŸ¥¬' },
    'tofu': { kcalPerUnit: 144, defaultUnit: '100g', emoji: 'ğŸ¥¢' }
  };

  // Dane aplikacji
  let userData = {
    basicInfo: {},
    measurements: [],
    meals: [],
    currentMeasurementIndex: 0,
    currentMealIndex: 0,
    currentMealPage: 0
  };

  // Klasyfikacja BMI z zaleceniami aktywnoÅ›ci
  const bmiClassifications = {
    underweight: {
      range: "poniÅ¼ej 18.5",
      name: "Niedowaga",
      class: "bmi-underweight",
      activities: [
        "Zalecenia:",
        "- Spacer 3-4x w tygodniu (20-30 min)",
        "- Marsz 2-3x w tygodniu",
        "- Lekki trening siÅ‚owy z maÅ‚ymi obciÄ…Å¼eniami",
        "- Joga/Pilates dla poczÄ…tkujÄ…cych"
      ]
    },
    normal: {
      range: "18.5 - 24.9", 
      name: "Waga prawidÅ‚owa",
      class: "bmi-normal",
      activities: [
        "Zalecenia:",
        "- Marszobiegi 3-4x w tygodniu",
        "- Jazda na rowerze 2-3x w tygodniu",
        "- Trening siÅ‚owy 3x w tygodniu",
        "- PÅ‚ywanie/Aerobik wodny"
      ]
    },
    overweight: {
      range: "25 - 29.9",
      name: "Nadwaga",
      class: "bmi-overweight",
      activities: [
        "Zalecenia:",
        "- Spacer 5-6x w tygodniu (30-45 min)",
        "- Marsz 3-4x w tygodniu",
        "- Rower stacjonarny/niskie obciÄ…Å¼enie",
        "- Aqua aerobik"
      ]
    },
    obesity1: {
      range: "30 - 34.9",
      name: "OtyÅ‚oÅ›Ä‡ I stopnia",
      class: "bmi-obesity1",
      activities: [
        "Zalecenia:",
        "- Spacer 5x w tygodniu (20-30 min)",
        "- Ä†wiczenia w wodzie",
        "- Ä†wiczenia na siedzÄ…co",
        "- Stopniowe zwiÄ™kszanie aktywnoÅ›ci"
      ]
    },
    obesity2: {
      range: "35 - 39.9",
      name: "OtyÅ‚oÅ›Ä‡ II stopnia",
      class: "bmi-obesity2",
      activities: [
        "Zalecenia:",
        "- KrÃ³tkie spacery 3-4x dziennie (10-15 min)",
        "- Ä†wiczenia oddechowe",
        "- RozciÄ…ganie",
        "- Konsultacja z lekarzem przed treningami"
      ]
    },
    obesity3: {
      range: "powyÅ¼ej 40",
      name: "OtyÅ‚oÅ›Ä‡ III stopnia",
      class: "bmi-obesity3",
      activities: [
        "Zalecenia:",
        "- Bardzo krÃ³tkie spacery (5-10 min)",
        "- Ä†wiczenia pod okiem specjalisty",
        "- Konieczna konsultacja lekarska",
        "- Stopniowa rehabilitacja ruchowa"
      ]
    }
  };

  // SzczegÃ³Å‚owe zalecenia aktywnoÅ›ci dla rÃ³Å¼nych zakresÃ³w BMI
  const detailedActivityRecommendations = {
    16.0: "ğŸš¶ *Spacery lekkie 30 min* 3x/tydz. <br> ğŸš² *Rower na pÅ‚askim 20â€“30 min* 2x/tydz. <br> ğŸ§˜ *Stretching oddechowy* codziennie <br> ğŸ§ *Ä†wiczenia postawy (5â€“10 min)* codziennie",
    16.5: "ğŸš¶ *Marsz spokojny 35 min* 3x/tydz. <br> ğŸš´ *Rower stacjonarny lekki 30 min* 2x/tydz. <br> ğŸ§˜ *Joga statyczna* 3x/tydz. <br> ğŸ¤¸ *Ä†wiczenia rÃ³wnowagi* 2x/tydz.",
    17.0: "ğŸš¶ *Marsz umiarkowany 40 min* 3x/tydz. <br> ğŸš² *Rower rekreacyjny 30â€“40 min* 2x/tydz. <br> ğŸ§˜ *Stretching z oddechem* codziennie <br> ğŸ‹ï¸ *Gumy oporowe â€“ lekki trening* 2x/tydz.",
    17.5: "ğŸš¶ *Szybki marsz 45 min* 3x/tydz. <br> ğŸš´ *Rower miejski 40 min* 2x/tydz. <br> ğŸ§˜ *Mobility + joga* 3x/tydz. <br> ğŸ‹ï¸ *Ä†wiczenia z ciÄ™Å¼arem wÅ‚asnym* 2x/tydz.",
    18.0: "ğŸš¶ *Marsz tempowy 50 min* 3x/tydz. <br> ğŸš² *Rower terenowy 40 min* 2x/tydz. <br> ğŸ§˜ *Joga dynamiczna* 2x/tydz. <br> ğŸ‹ï¸ *Trening funkcjonalny* 2x/tydz.",
    18.5: "ğŸš¶ *Marsz z kijkami 50 min* 3â€“4x/tydz. <br> ğŸš² *Rower interwaÅ‚owy lekki 45 min* 2x/tydz. <br> ğŸƒ *Trucht 20 min* 2x/tydz. <br> ğŸ§˜ *Stretching po wysiÅ‚ku* codziennie",
    19.0: "ğŸš¶ *Szybki marsz 60 min* 3x/tydz. <br> ğŸš´ *Rower szosowy 45 min* 2x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia â€“ obwody 30 min* 2x/tydz. <br> ğŸ§˜ *Relaksacja i mobilnoÅ›Ä‡* codziennie",
    19.5: "ğŸƒ *Trucht ciÄ…gÅ‚y 30 min* 3x/tydz. <br> ğŸš´ *Rower z 3 interwaÅ‚ami* 45 min 2x/tydz. <br> ğŸ‹ï¸ *Trening obwodowy z masÄ… ciaÅ‚a* 2x/tydz. <br> ğŸ§˜ *Stretching dolnych partii* codziennie",
    20.0: "ğŸƒ *Trucht + sprint 4x20s* 3x/tydz. <br> ğŸš´ *Rower interwaÅ‚owy 50 min* 2x/tydz. <br> ğŸ‹ï¸ *Split gÃ³ra/dÃ³Å‚ na siÅ‚owni* 3x/tydz. <br> ğŸ§˜ *Stretching aktywny* codziennie",
    20.5: "ğŸƒ *Bieg progresywny 35 min* 3x/tydz. <br> ğŸš´ *Rower + 5x1min mocno* 2x/tydz. <br> ğŸ‹ï¸ *Full body + core* 3x/tydz. <br> ğŸ§˜ *Rolowanie wieczorne* codziennie",
    21.0: "ğŸƒ *Bieg 5 km tempem umiarkowanym* 2x/tydz. <br> ğŸš´ *Rower + interwaÅ‚y 4x2min* 2x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia push/pull/legs* 3x/tydz. <br> ğŸ§˜ *Stretching dynamiczny* codziennie",
    21.5: "ğŸƒ *Bieg interwaÅ‚owy 6x400m* 2x/tydz. <br> ğŸš´ *Rower terenowy 60 min* 2x/tydz. <br> ğŸ‹ï¸ *Trening siÅ‚owy + mobilnoÅ›Ä‡* 3x/tydz. <br> ğŸ§˜ *Joga aktywna 20 min* codziennie",
    22.0: "ğŸš¶ *Szybki marsz 40 min* 3x/tydz. <br> ğŸš² *Rower miejski 45 min* 2x/tydz. <br> ğŸ§˜ *Joga siÅ‚owa (Vinyasa)* 2x/tydz. <br> ğŸ‹ï¸ *Ä†wiczenia wÅ‚asnÄ… masÄ… ciaÅ‚a* 2x/tydz.",
    22.5: "ğŸš¶ *Marsz z kijkami 45 min* 3â€“4x/tydz. <br> ğŸš´ *Rower w terenie mieszanym 45 min* 2x/tydz. <br> ğŸ‹ï¸ *Obwodowy trening domowy* 2x/tydz. <br> ğŸ§˜ *RozciÄ…ganie funkcjonalne* codziennie",
    23.0: "ğŸƒ *Marszobieg 3x5 min + marsz* 2x/tydz. <br> ğŸš² *Rower 60 min â€“ tempo umiarkowane* 2x/tydz. <br> ğŸ‹ï¸ *Trening siÅ‚owy na maszynach* 2x/tydz. <br> ğŸ§˜ *MobilnoÅ›Ä‡ + foam rolling* 3x/tydz.",
    23.5: "ğŸƒ *Trucht 20â€“30 min* 3x/tydz. <br> ğŸš´ *Rower interwaÅ‚owy 40 min* 2x/tydz. <br> ğŸ‹ï¸ *Cross-trening lekki* 2x/tydz. <br> ï¿½ *Stretching statyczny* 10 min po treningu",
    24.0: "ğŸƒ *Trucht/Bieg 30 min* 3x/tydz. <br> ğŸš´ *Rower + podjazdy 45 min* 2x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia: FBW lub Split* 3x/tydz. <br> ğŸ§˜ *Joga siÅ‚owa lub Pilates* 2x/tydz.",
    24.5: "ğŸƒ *Bieg 35â€“40 min w tempie konwersacyjnym* 3x/tydz. <br> ğŸš´ *Rower interwaÅ‚y 50 min* 2x/tydz. <br> ğŸ‹ï¸ *Trening funkcjonalny* 3x/tydz. <br> ğŸ§˜ *Stretching aktywny* 3x/tydz.",
    25.0: "ğŸš¶ *Marsz szybki 60 min* 4x/tydz. <br> ğŸš² *Rower 60 min z 5 interwaÅ‚ami* 2x/tydz. <br> ğŸ‹ï¸ *Trening siÅ‚owy FBW* 3x/tydz. <br> ğŸ§˜ *Stretching wieczorny* codziennie",
    25.5: "ğŸš¶ *Nordic walking 50â€“60 min* 4x/tydz. <br> ğŸš´ *Rower interwaÅ‚owy 45 min* 3x/tydz. <br> ğŸ‹ï¸ *TRX lub gumy oporowe* 2x/tydz. <br> ğŸ§˜ *RozciÄ…ganie i oddech* codziennie",
    26.0: "ğŸƒ *Marszobieg 40 min (1:1 min)* 3x/tydz. <br> ğŸš² *Rower 60 min ze zmianÄ… tempa* 3x/tydz. <br> ğŸ‹ï¸ *Trening siÅ‚owy Split* 3x/tydz. <br> ğŸ§˜ *Foam rolling* po kaÅ¼dym treningu",
    26.5: "ğŸš¶ *Marsz 60 min dziennie* 5x/tydz. <br> ğŸš´ *Rower + 10-min interwaÅ‚* 2x/tydz. <br> ğŸ‹ï¸ *Ä†wiczenia funkcjonalne* 3x/tydz. <br> ğŸ§˜ *Mobility + relaksacja* codziennie",
    27.0: "ğŸš¶ *Marsz + podbiegi 45 min* 4x/tydz. <br> ğŸš² *Rower 60 min staÅ‚e tempo* 3x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia + interwaÅ‚ cardio* 2x/tydz. <br> ğŸ§˜ *Stretching* codziennie",
    27.5: "ğŸš¶ *Marsz z obciÄ…Å¼eniem (plecak 5 kg)* 4x/tydz. <br> ğŸš´ *Rower ze zmianÄ… tempa 60 min* 2x/tydz. <br> ğŸ‹ï¸ *Full body training* 2x/tydz. <br> ğŸ§˜ *Stretch + oddech* codziennie",
    28.0: "ğŸš¶ *Nordic walking 60 min* 4â€“5x/tydz. <br> ğŸš´ *Rower interwaÅ‚owy 60 min* 2x/tydz. <br> ğŸ‹ï¸ *Trening funkcjonalny* 2â€“3x/tydz. <br> ğŸ§˜ *RozciÄ…ganie aktywne* 3x/tydz.",
    28.5: "ğŸš¶ *Marsz szybki 60 min* 5x/tydz. <br> ğŸš² *Rower 45 min (70% HRmax)* 3x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia: Ä‡wiczenia wielostawowe* 3x/tydz. <br> ğŸ§˜ *Joga + mobilnoÅ›Ä‡* 3x/tydz.",
    29.0: "ğŸš¶ *2x dziennie po 30 min* <br> ğŸš´ *Rower stacjonarny 45 min* 2x/tydz. <br> ğŸ‹ï¸ *Trening domowy z ciÄ™Å¼arkami* 2x/tydz. <br> ğŸ§˜ *Foam rolling + stretching* codziennie",
    29.5: "ğŸš¶ *60â€“75 min marszu dziennie* 5x/tydz. <br> ğŸš´ *Rower 60 min (65% HRmax)* 3x/tydz. <br> ğŸ‹ï¸ *Trening oporowy + cardio* 3x/tydz. <br> ğŸ§˜ *Stretching + oddech* codziennie",
    30.0: "ğŸš¶ *2x dziennie po 30 min* <br> ğŸ§˜ *Codzienne rozciÄ…ganie* 10â€“15 min <br> ğŸ‹ï¸ *Trening w domu (mata, krzesÅ‚o)* 3x/tydz. <br> ğŸš´ *Rower stacjonarny* 3x/tydz.",
    30.5: "ğŸš¶ *Marsz 45 min* 5x/tydz. <br> ğŸ§˜ *Joga krzesÅ‚owa* 3x/tydz. <br> ğŸ‹ï¸ *Ä†wiczenia z gumami* 2x/tydz. <br> ğŸš´ *Rower stacjonarny 30 min* 2x/tydz.",
    31.0: "ğŸš´ *Rower stacjonarny 45 min* 3x/tydz. (60% HRmax) <br> ğŸ§˜ *Joga dla osÃ³b otyÅ‚ych* 2x/tydz. <br> ğŸš¶ *Marsz po schodach (1â€“2 piÄ™tra)* 2x/tydz. <br> ğŸ‹ï¸ *Mini obwody* 2x/tydz.",
    31.5: "ğŸš¶ *Marsz 40 min* 5x/tydz. <br> ğŸ§˜ *RozciÄ…ganie siedzÄ…ce* codziennie <br> ğŸ‹ï¸ *Ä†wiczenia z ciÄ™Å¼arem wÅ‚asnym* 2x/tydz. <br> ğŸš´ *Rower wodny* 2x/tydz.",
    32.0: "ğŸ‹ï¸ *Ä†wiczenia z gumami* 2x/tydz. po 30 min <br> ğŸš¶ *Marsze z kijkami* 4x/tydz. <br> ğŸš´ *Rower stacjonarny 50 min* 3x/tydz. <br> ğŸ§˜ *Stretching wieczorny* codziennie",
    32.5: "ğŸš¶ *Marsz 50 min* 5x/tydz. <br> ğŸ§˜ *Joga leÅ¼Ä…ca* 3x/tydz. <br> ğŸ‹ï¸ *Trening rehabilitacyjny* 2x/tydz. <br> ğŸš´ *Rower poziomy* 2x/tydz.",
    33.0: "ğŸš´ *Rower 60 min* 3x/tydz. (staÅ‚y wysiÅ‚ek) <br> ğŸ§˜ *Stretching + uwaÅ¼noÅ›Ä‡* 3x/tydz. <br> ğŸš¶ *Marsz tempowy 60 min* 4x/tydz. <br> ğŸ‹ï¸ *Bodyweight training* 2x/tydz.",
    33.5: "ğŸš¶ *Marsz 55 min* 5x/tydz. <br> ğŸ§˜ *Ä†wiczenia oddechowe* codziennie <br> ğŸ‹ï¸ *Trening w wodzie* 2x/tydz. <br> ğŸš´ *Rower stacjonarny 40 min* 2x/tydz.",
    34.0: "ğŸš¶ *Marsz z plecakiem 60 min* 5x/tydz. <br> ğŸš´ *Rower pod gÃ³rkÄ™ 45 min* 2x/tydz. <br> ğŸ‹ï¸ *SiÅ‚ownia: maszyny + gumy* 3x/tydz. <br> ğŸ§˜ *Foam roller + oddech* codziennie",
    34.5: "ğŸš¶ *Marsz 2x30 min* codziennie <br> ğŸ§˜ *Relaksacja* codziennie <br> ğŸ‹ï¸ *Ä†wiczenia z fizjoterapeutÄ…* 2x/tydz. <br> ğŸš´ *Rower ergometr* 2x/tydz.",
    35.0: "ğŸš¶ *Marsz 2x po 30 min* codziennie <br> ğŸš´ *Rower stacjonarny 60 min* 3x/tydz. <br> ğŸ§˜ *Relaksacja i rozciÄ…ganie* codziennie <br> ğŸ‹ï¸ *Mini trening obwodowy* 2x/tydz.",
    35.5: "ğŸš¶ *Spacer 3x20 min* codziennie <br> ğŸ§˜ *Joga krzesÅ‚owa* codziennie <br> ğŸ‹ï¸ *Ä†wiczenia rehabilitacyjne* 2x/tydz. <br> ğŸš´ *Rower poziomy 30 min* 2x/tydz.",
    36.0: "ğŸš¶ *Nordic walking 60 min* 5x/tydz. <br> ğŸ§˜ *Joga leÅ¼Ä…ca / krzesÅ‚owa* codziennie <br> ğŸš´ *Rower lekki 40 min* 3x/tydz. <br> ğŸ‹ï¸ *Ä†wiczenia rehabilitacyjne* 2x/tydz.",
    36.5: "ğŸš¶ *Spacer 3x25 min* codziennie <br> ğŸ§˜ *Stretching siedzÄ…cy* codziennie <br> ğŸ‹ï¸ *Trening pod okiem specjalisty* 2x/tydz. <br> ğŸš´ *Rower wodny* 1x/tydz.",
    37.0: "ğŸš¶ *Marsze 2x dziennie* po 30â€“45 min <br> ğŸš´ *Rower poziomy (ergometr)* 3x/tydz. <br> ğŸ§˜ *Stretching leÅ¼Ä…cy* codziennie <br> ğŸ‹ï¸ *Trening w wodzie* 1â€“2x/tydz.",
    37.5: "ğŸš¶ *Spacer 4x20 min* codziennie <br> ğŸ§˜ *Ä†wiczenia oddechowe* codziennie <br> ğŸ‹ï¸ *Fizjoterapia* 2x/tydz. <br> ğŸš´ *Rower stacjonarny 20 min* 2x/tydz.",
    38.0: "ğŸš¶ *Chodzenie po pÅ‚askim 60 min* 5x/tydz. <br> ğŸš´ *Rower wodny lub stacjonarny* 2x/tydz. <br> ğŸ§˜ *Ä†wiczenia oddechowe i mobilnoÅ›Ä‡* <br> ğŸ‹ï¸ *Mini trening z fizjoterapeutÄ…*",
    38.5: "ğŸš¶ *Spacer 3x20 min* codziennie <br> ğŸ§˜ *Joga leÅ¼Ä…ca* codziennie <br> ğŸ‹ï¸ *Ä†wiczenia z pomocÄ…* 2x/tydz. <br> ğŸš´ *Rower poziomy 15 min* 2x/tydz.",
    39.0: "ğŸš¶ *Spacery + krÃ³tkie przerwy w ciÄ…gu dnia* 6x/tydz. <br> ğŸ§˜ *RozciÄ…ganie 15 min rano + wieczorem* <br> ğŸš´ *Rower stacjonarny z niskim oporem* 2x/tydz.",
    39.5: "ğŸš¶ *Spacer 4x15 min* codziennie <br> ğŸ§˜ *Relaksacja oddechowa* codziennie <br> ğŸ‹ï¸ *Fizjoterapia* 2x/tydz. <br> ğŸš´ *Rower poziomy 10 min* 1x/tydz.",
    40.0: "ğŸš¶ *Marsze z asekuracjÄ… 30 min* 5x/tydz. <br> ğŸ§˜ *Stretching i Ä‡wiczenia oddechowe* codziennie <br> ğŸ‹ï¸ *Treningi na siedzÄ…co / fizjoterapia* 2x/tydz. <br> ğŸš´ *Rower poziomy* 2x/tydz."
  };

  // Typy posiÅ‚kÃ³w z godzinami prezentacji
  const mealTypes = {
    breakfast: {
      name: "Åšniadanie",
      startHour: 0,
      endHour: 11.5
    },
    second_breakfast: {
      name: "II Åšniadanie",
      startHour: 9,
      endHour: 12
    },
    lunch: {
      name: "Obiad",
      startHour: 11.51,
      endHour: 16.5
    },
    snack: {
      name: "Podwieczorek",
      startHour: 15,
      endHour: 18
    },
    dinner: {
      name: "Kolacja",
      startHour: 16.51,
      endHour: 23.98
    }
  };

  // Funkcja do logowania w konsoli
  function logToConsole(message, type = 'log') {
    const timestamp = new Date().toLocaleTimeString();
    const logMessage = `[${timestamp}] ${message}`;
    
    switch(type) {
      case 'error':
        console.error(logMessage);
        break;
      case 'warn':
        console.warn(logMessage);
        break;
      case 'info':
        console.info(logMessage);
        break;
      default:
        console.log(logMessage);
    }
  }

  // Funkcja do wyÅ›wietlania bÅ‚Ä™dÃ³w walidacji
  function showError(element, message) {
    const errorElement = document.createElement('div');
    errorElement.className = 'error-message';
    errorElement.textContent = message;
    
    const existingError = element.nextElementSibling;
    if (existingError && existingError.classList.contains('error-message')) {
      existingError.remove();
    }
    
    element.classList.add('has-error');
    element.after(errorElement);
    errorElement.style.display = 'block';
    
    logToConsole(`BÅ‚Ä…d walidacji: ${message}`, 'error');
  }

  // Funkcja do usuwania bÅ‚Ä™dÃ³w walidacji
  function clearError(element) {
    element.classList.remove('has-error');
    const errorElement = element.nextElementSibling;
    if (errorElement && errorElement.classList.contains('error-message')) {
      errorElement.style.display = 'none';
    }
  }

  // Inicjalizacja
  document.addEventListener('DOMContentLoaded', function() {
    logToConsole('Aplikacja zainicjalizowana', 'info');
    
    // Przyciski
    document.getElementById('addMeasurementBtn').addEventListener('click', function() {
      logToConsole('KlikniÄ™to przycisk "Dodaj nowy pomiar"', 'info');
      showMeasurementModal();
    });

    document.getElementById('addMealBtn').addEventListener('click', function() {
      logToConsole('KlikniÄ™to przycisk "Dodaj posiÅ‚ek"', 'info');
      showMealModal();
    });

    // Formularze
    document.getElementById('initialForm').addEventListener('submit', handleInitialFormSubmit);
    document.getElementById('measurementForm').addEventListener('submit', handleMeasurementFormSubmit);
    document.getElementById('mealForm').addEventListener('submit', handleMealFormSubmit);

    // Przycisk dodawania skÅ‚adnika
    document.getElementById('addIngredientBtn').addEventListener('click', function() {
      logToConsole('KlikniÄ™to przycisk "Dodaj skÅ‚adnik"', 'info');
      addIngredient();
    });

    // AutouzupeÅ‚nianie skÅ‚adnikÃ³w
    document.getElementById('newIngredientName').addEventListener('input', function(e) {
      const input = e.target;
      const val = input.value.toLowerCase();
      const autocompleteList = document.getElementById('autocompleteList');
      
      autocompleteList.innerHTML = '';
      
      if (val.length < 2) return;
      
      const matches = Object.keys(ingredientDatabase).filter(
        key => key.toLowerCase().includes(val)
      ).slice(0, 5);
      
      matches.forEach(match => {
        const item = document.createElement('div');
        item.innerHTML = `${ingredientDatabase[match].emoji || 'ğŸ´'} ${match}`;
        item.addEventListener('click', function() {
          input.value = match;
          autocompleteList.innerHTML = '';
          
          const defaultUnit = ingredientDatabase[match].defaultUnit;
          const unitSelect = document.getElementById('newIngredientUnit');
          
          if (defaultUnit === '100g') {
            unitSelect.value = 'g';
          } else if (defaultUnit === '100ml') {
            unitSelect.value = 'ml';
          } else {
            unitSelect.value = defaultUnit;
          }
          
          logToConsole(`Wybrano skÅ‚adnik z autouzupeÅ‚niania: ${match} (jednostka: ${unitSelect.value})`, 'info');
        });
        autocompleteList.appendChild(item);
      });
    });

    // Wczytaj dane z localStorage
    loadData();
  });

  // Pokaz modal posiÅ‚kÃ³w
  function showMealModal() {
    logToConsole('Otwieranie modalu posiÅ‚kÃ³w', 'info');
    const form = document.getElementById('mealForm');
    form.reset();
    document.getElementById('ingredientList').innerHTML = '';
    document.getElementById('mealCaloriesDisplay').textContent = 'Suma kalorii: 0 kcal';
    document.getElementById('mealModal').style.display = 'flex';
    
    document.querySelectorAll('.has-error').forEach(el => el.classList.remove('has-error'));
    document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
    
    const now = new Date();
    const currentHour = now.getHours() + now.getMinutes() / 60;
    let defaultMealType = '';
    
    for (const [type, details] of Object.entries(mealTypes)) {
      if (currentHour >= details.startHour && currentHour <= details.endHour) {
        defaultMealType = type;
        break;
      }
    }
    
    if (defaultMealType) {
      document.getElementById('mealType').value = defaultMealType;
      logToConsole(`Ustawiono domyÅ›lny typ posiÅ‚ku: ${defaultMealType} (aktualna godzina: ${currentHour.toFixed(2)})`, 'info');
    }
  }

  // ObsÅ‚uga formularza poczÄ…tkowego
  function handleInitialFormSubmit(e) {
    e.preventDefault();
    logToConsole('Przetwarzanie formularza poczÄ…tkowego', 'info');
    
    const formData = new FormData(e.target);
    userData.basicInfo = {
      name: formData.get('name'),
      age: parseInt(formData.get('age')),
      height: parseInt(formData.get('height')),
      targetWeight: parseFloat(formData.get('targetWeight'))
    };
    
    userData.basicInfo.gender = "male";
    
    logToConsole('Dane podstawowe zapisane:', 'info');
    console.dir(userData.basicInfo);
    
    showMeasurementModal();
    document.getElementById('initialModal').style.display = 'none';
  }

  // Pokaz modal pomiarÃ³w
  function showMeasurementModal() {
    logToConsole('Otwieranie modalu pomiarÃ³w', 'info');
    const form = document.getElementById('measurementForm');
    form.reset();
    
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('measurementDate').value = today;
    
    if (userData.measurements.length > 0) {
      const lastMeasurement = userData.measurements[userData.measurements.length - 1];
      document.getElementById('currentWeight').value = lastMeasurement.currentWeight || '';
      document.getElementById('waist').value = lastMeasurement.waist || '';
      document.getElementById('wrist').value = lastMeasurement.wrist || '';
      document.getElementById('thigh').value = lastMeasurement.thigh || '';
      
      logToConsole('Ustawiono wartoÅ›ci z ostatniego pomiaru jako podpowiedÅº', 'info');
    }
    
    document.getElementById('measurementModal').style.display = 'flex';
  }

  // ObsÅ‚uga formularza pomiarÃ³w
  function handleMeasurementFormSubmit(e) {
    e.preventDefault();
    logToConsole('Przetwarzanie formularza pomiarÃ³w', 'info');
    
    const formData = new FormData(e.target);
    const measurement = {
      date: formData.get('measurementDate'),
      currentWeight: parseFloat(formData.get('currentWeight')),
      waist: formData.get('waist') ? parseInt(formData.get('waist')) : null,
      wrist: formData.get('wrist') ? parseInt(formData.get('wrist')) : null,
      thigh: formData.get('thigh') ? parseInt(formData.get('thigh')) : null,
      timestamp: new Date(formData.get('measurementDate')).getTime()
    };
    
    logToConsole('Nowy pomiar:', 'info');
    console.dir(measurement);
    
    userData.measurements.unshift(measurement);
    userData.currentMeasurementIndex = 0;
    
    saveData();
    document.getElementById('measurementModal').style.display = 'none';
    updateUI();
  }

  // Dodaj skÅ‚adnik do listy
  function addIngredient() {
    const nameInput = document.getElementById('newIngredientName');
    const amountInput = document.getElementById('newIngredientAmount');
    const unitSelect = document.getElementById('newIngredientUnit');
    
    const name = nameInput.value.trim();
    const amount = parseFloat(amountInput.value);
    const unit = unitSelect.value;
    
    logToConsole(`PrÃ³ba dodania skÅ‚adnika: ${name}, ${amount} ${unit}`, 'info');
    
    if (!name) {
      showError(nameInput, 'ProszÄ™ podaÄ‡ nazwÄ™ skÅ‚adnika');
      logToConsole('BÅ‚Ä…d: Brak nazwy skÅ‚adnika', 'error');
      return;
    } else {
      clearError(nameInput);
    }
    
    if (isNaN(amount)) {
      showError(amountInput, 'ProszÄ™ podaÄ‡ prawidÅ‚owÄ… iloÅ›Ä‡');
      logToConsole('BÅ‚Ä…d: NieprawidÅ‚owa iloÅ›Ä‡ skÅ‚adnika', 'error');
      return;
    } else if (amount <= 0) {
      showError(amountInput, 'IloÅ›Ä‡ musi byÄ‡ wiÄ™ksza od zera');
      logToConsole('BÅ‚Ä…d: IloÅ›Ä‡ skÅ‚adnika musi byÄ‡ > 0', 'error');
      return;
    } else {
      clearError(amountInput);
    }
    
    const validAmount = amount;
    const ingredientKey = Object.keys(ingredientDatabase).find(
      key => key.toLowerCase() === name.toLowerCase()
    ) || name;
    
    const ingredientInfo = ingredientDatabase[ingredientKey] || { 
      kcalPerUnit: 0,
      defaultUnit: 'g',
      emoji: 'ğŸ´'
    };
    
    let calories = 0;
    if (unit === 'szt') {
      calories = ingredientInfo.kcalPerUnit * validAmount;
    } else if (unit === 'g') {
      calories = (ingredientInfo.kcalPerUnit / 100) * validAmount;
    } else if (unit === 'kg') {
      calories = (ingredientInfo.kcalPerUnit / 100) * (validAmount * 1000);
    } else if (unit === 'ml') {
      calories = (ingredientInfo.kcalPerUnit / 100) * validAmount;
    }
    
    logToConsole(`Dodano skÅ‚adnik: ${ingredientKey} (${validAmount} ${unit}) - ${calories.toFixed(0)} kcal`, 'info');
    
    const ingredientList = document.getElementById('ingredientList');
    const ingredientId = Date.now();
    
    const ingredientItem = document.createElement('div');
    ingredientItem.className = 'ingredient-item';
    ingredientItem.dataset.id = ingredientId;
    ingredientItem.dataset.calories = calories;
    ingredientItem.dataset.name = ingredientKey;
    ingredientItem.dataset.amount = `${validAmount} ${unit}`;
    ingredientItem.dataset.emoji = ingredientInfo.emoji;
    ingredientItem.innerHTML = `
      <span class="ingredient-name">${ingredientInfo.emoji || 'ğŸ´'} ${ingredientKey} (${validAmount} ${unit})</span>
      <span class="ingredient-calories">${calories.toFixed(0)} kcal</span>
      <button type="button" class="remove-ingredient-btn" onclick="removeIngredient('${ingredientId}')">-</button>
    `;
    
    ingredientList.appendChild(ingredientItem);
    updateTotalCalories();
    
    nameInput.value = '';
    amountInput.value = '';
    document.getElementById('autocompleteList').innerHTML = '';
  }

  // UsuÅ„ skÅ‚adnik z listy
  function removeIngredient(id) {
    logToConsole(`Usuwanie skÅ‚adnika o ID: ${id}`, 'info');
    const ingredient = document.querySelector(`.ingredient-item[data-id="${id}"]`);
    if (ingredient) {
      const name = ingredient.dataset.name;
      const amount = ingredient.dataset.amount;
      const calories = ingredient.dataset.calories;
      
      logToConsole(`UsuniÄ™to skÅ‚adnik: ${name} (${amount}) - ${calories} kcal`, 'info');
      
      ingredient.remove();
      updateTotalCalories();
    }
  }

  // Oblicz caÅ‚kowitÄ… liczbÄ™ kalorii
  function updateTotalCalories() {
    const ingredients = document.querySelectorAll('.ingredient-item');
    let totalCalories = 0;
    
    ingredients.forEach(ingredient => {
      const calories = parseFloat(ingredient.dataset.calories) || 0;
      totalCalories += calories;
    });
    
    document.getElementById('mealCaloriesDisplay').textContent = 
      `Suma kalorii: ${totalCalories.toFixed(0)} kcal`;
    
    logToConsole(`Zaktualizowano sumÄ™ kalorii: ${totalCalories.toFixed(0)} kcal`, 'info');
  }

  // ObsÅ‚uga formularza posiÅ‚kÃ³w
  function handleMealFormSubmit(e) {
    e.preventDefault();
    
    logToConsole('RozpoczÄ™to dodawanie posiÅ‚ku', 'info');
    
    const formData = new FormData(e.target);
    const ingredients = [];
    let totalCalories = 0;
    
    const ingredientItems = document.querySelectorAll('.ingredient-item');
    logToConsole(`Znaleziono ${ingredientItems.length} skÅ‚adnikÃ³w`, 'info');
    
    ingredientItems.forEach(item => {
      const name = item.dataset.name;
      const amount = item.dataset.amount;
      const calories = parseFloat(item.dataset.calories) || 0;
      const emoji = item.dataset.emoji || 'ğŸ´';
      
      logToConsole(`Przetwarzanie skÅ‚adnika: ${emoji} ${name} (${amount}) - ${calories} kcal`, 'info');
      
      ingredients.push({
        name: name,
        amount: amount,
        calories: calories,
        emoji: emoji
      });
      
      totalCalories += calories;
    });
    
    if (ingredients.length === 0) {
      showError(document.getElementById('ingredientList'), 'Dodaj przynajmniej jeden skÅ‚adnik');
      logToConsole('BÅ‚Ä…d: Brak skÅ‚adnikÃ³w w posiÅ‚ku', 'error');
      return;
    } else {
      clearError(document.getElementById('ingredientList'));
    }
    
    const mealName = formData.get('mealName');
    if (!mealName || mealName.trim() === '') {
      showError(document.getElementById('mealName'), 'ProszÄ™ podaÄ‡ nazwÄ™ posiÅ‚ku');
      logToConsole('BÅ‚Ä…d: Brak nazwy posiÅ‚ku', 'error');
      return;
    } else {
      clearError(document.getElementById('mealName'));
    }
    
    const mealType = formData.get('mealType');
    if (!mealType) {
      showError(document.getElementById('mealType'), 'ProszÄ™ wybraÄ‡ typ posiÅ‚ku');
      logToConsole('BÅ‚Ä…d: Brak typu posiÅ‚ku', 'error');
      return;
    } else {
      clearError(document.getElementById('mealType'));
    }
    
    logToConsole(`Suma kalorii: ${totalCalories.toFixed(0)} kcal`, 'info');
    
    const meal = {
      name: mealName.trim(),
      type: mealType,
      ingredients: ingredients,
      totalCalories: totalCalories,
      date: new Date().toISOString().split('T')[0],
      timestamp: new Date().getTime()
    };
    
    logToConsole('Utworzono obiekt posiÅ‚ku:', 'info');
    console.dir(meal);
    
    if (!userData.meals) {
      userData.meals = [];
      logToConsole('Inicjalizacja tablicy posiÅ‚kÃ³w', 'info');
    }
    
    userData.meals.unshift(meal);
    userData.currentMealIndex = 0;
    userData.currentMealPage = 0;
    
    logToConsole('PosiÅ‚ek dodany pomyÅ›lnie', 'info');
    
    saveData();
    document.getElementById('mealModal').style.display = 'none';
    updateMealList();
    
    e.target.reset();
    document.getElementById('ingredientList').innerHTML = '';
    document.getElementById('mealCaloriesDisplay').textContent = 'Suma kalorii: 0 kcal';
  }

  // ZaÅ‚aduj dane z localStorage
  function loadData() {
    logToConsole('PrÃ³ba wczytania danych z localStorage', 'info');
    const savedData = localStorage.getItem('fitnessAppData');
    if (savedData) {
      try {
        userData = JSON.parse(savedData);
        
        if (!userData.meals) userData.meals = [];
        if (!userData.measurements) userData.measurements = [];
        if (!userData.basicInfo) userData.basicInfo = {};
        if (userData.currentMeasurementIndex === undefined) userData.currentMeasurementIndex = 0;
        if (userData.currentMealIndex === undefined) userData.currentMealIndex = 0;
        if (userData.currentMealPage === undefined) userData.currentMealPage = 0;
        
        logToConsole('Dane wczytane pomyÅ›lnie z localStorage', 'info');
        console.dir(userData);
        
        updateUI();
        updateMealList();
        updateWeeklyPlan();
      } catch (e) {
        logToConsole('BÅ‚Ä…d podczas parsowania danych z localStorage: ' + e.message, 'error');
        document.getElementById('initialModal').style.display = 'flex';
      }
    } else {
      logToConsole('Brak danych w localStorage - pokazujÄ™ modal poczÄ…tkowy', 'info');
      document.getElementById('initialModal').style.display = 'flex';
    }
  }

  // Zapisz dane do localStorage
  function saveData() {
    logToConsole('Zapisywanie danych do localStorage', 'info');
    try {
      localStorage.setItem('fitnessAppData', JSON.stringify(userData));
      logToConsole('Dane zapisane pomyÅ›lnie', 'info');
    } catch (e) {
      logToConsole('BÅ‚Ä…d podczas zapisywania danych do localStorage: ' + e.message, 'error');
    }
  }

  // Aktualizuj interfejs uÅ¼ytkownika
  function updateUI() {
    logToConsole('Aktualizacja interfejsu uÅ¼ytkownika', 'info');
    if (!userData.measurements || userData.measurements.length === 0) {
      logToConsole('Brak pomiarÃ³w do wyÅ›wietlenia', 'info');
      return;
    }
    
    const currentMeasurement = userData.measurements[userData.currentMeasurementIndex];
    const basicInfo = userData.basicInfo;
    
    displayUserData(currentMeasurement, basicInfo);
    updateSummary(currentMeasurement, basicInfo);
    updateMeasurementNavigation();
    updateWeeklyPlan();
  }

  // WyÅ›wietl dane uÅ¼ytkownika
  function displayUserData(measurement, basicInfo) {
    logToConsole('WyÅ›wietlanie danych uÅ¼ytkownika', 'info');
    const userDataContainer = document.getElementById('userData');
    userDataContainer.innerHTML = `
      <div class="user-data-item">
        <span class="user-data-label">ImiÄ™:</span>
        <span class="user-data-value">${basicInfo.name || 'Nie podano'}</span>
      </div>
      <div class="user-data-item">
        <span class="user-data-label">Wiek:</span>
        <span class="user-data-value">${basicInfo.age || 'Nie podano'} lat</span>
      </div>
      <div class="user-data-item">
        <span class="user-data-label">Wzrost:</span>
        <span class="user-data-value">${basicInfo.height || 'Nie podano'} cm</span>
      </div>
      <div class="user-data-item">
        <span class="user-data-label">Data pomiaru:</span>
        <span class="user-data-value">${measurement.date ? formatDate(measurement.date) : 'Nie podano'}</span>
      </div>
      <div class="user-data-item">
        <span class="user-data-label">Waga aktualna:</span>
        <span class="user-data-value">${measurement.currentWeight || 'Nie podano'} kg</span>
      </div>
      ${measurement.waist ? `
      <div class="user-data-item">
        <span class="user-data-label">ObwÃ³d pasa:</span>
        <span class="user-data-value">${measurement.waist} cm</span>
      </div>
      ` : ''}
      ${measurement.wrist ? `
      <div class="user-data-item">
        <span class="user-data-label">ObwÃ³d nadgarstka:</span>
        <span class="user-data-value">${measurement.wrist} cm</span>
      </div>
      ` : ''}
      ${measurement.thigh ? `
      <div class="user-data-item">
        <span class="user-data-label">ObwÃ³d uda:</span>
        <span class="user-data-value">${measurement.thigh} cm</span>
      </div>
      ` : ''}
    `;
  }

  // Formatuj datÄ™
  function formatDate(dateString) {
    if (!dateString) return 'Nie podano';
    const date = new Date(dateString);
    return date.toLocaleDateString('pl-PL');
  }

  // Aktualizuj podsumowanie
  function updateSummary(measurement, basicInfo) {
    logToConsole('Aktualizacja podsumowania', 'info');
    if (!measurement || !basicInfo || !basicInfo.height) {
      document.getElementById('summaryData').innerHTML = '<p>Brak danych do wyÅ›wietlenia</p>';
      logToConsole('Brak danych do wyÅ›wietlenia w podsumowaniu', 'info');
      return;
    }
    
    const bmi = (measurement.currentWeight / ((basicInfo.height/100) ** 2)).toFixed(1);
    const bmiCategory = getBmiCategory(bmi);
    const bmiInfo = bmiClassifications[bmiCategory];
    const calories = calculateCalories(measurement, basicInfo);
    
    let goalText = '';
    if (measurement.currentWeight > basicInfo.targetWeight + 2) {
      goalText = `Redukcja wagi - ${basicInfo.targetWeight} kg`; // TU BYÅ BÅÄ„D - targetWidth zamiast targetWeight
    } else if (measurement.currentWeight < basicInfo.targetWeight - 2) {
      goalText = `Budowa masy - ${basicInfo.targetWeight} kg`;
    } else {
      goalText = `Utrzymanie wagi - ${basicInfo.targetWeight} kg`;
    }

    document.getElementById('summaryData').innerHTML = `
      <div class="summary-item">
        <span class="summary-label">BMI:</span>
        <span class="summary-value ${bmiInfo.class}">${bmi} (${bmiInfo.name})</span>
      </div>
      <div class="summary-item">
        <span class="summary-label">Cel:</span>
        <span class="summary-value">${goalText}</span>
      </div>
      
      <div class="summary-item">
        <span class="summary-label">Cel kaloryczny:</span>
        <span class="summary-value">${calories.target} kcal/dzieÅ„</span>
      </div>
       <div class="summary-item">
        <div class="activity-tooltip">
          <div class="activity-content ${bmiInfo.class}">
            ${bmiInfo.activities.map(activity => 
              `<div class="activity-item">${activity.replace(/^[-â€¢] /, '')}</div>`
            ).join('')}
          </div>
        </div>
      </div>
    `;

    
    logToConsole('Podsumowanie zaktualizowane', 'info');
}

  // Oblicz zapotrzebowanie kaloryczne
  function calculateCalories(measurement, basicInfo) {
    if (!measurement || !basicInfo) {
      logToConsole('Brak danych do obliczenia zapotrzebowania kalorycznego', 'warn');
      return {
        maintenance: 0,
        target: 0,
        goal: 'maintain'
      };
    }
    
    let bmr;
    if (basicInfo.gender === "male") {
      bmr = 10 * measurement.currentWeight + 6.25 * basicInfo.height - 5 * basicInfo.age + 5;
    } else {
      bmr = 10 * measurement.currentWeight + 6.25 * basicInfo.height - 5 * basicInfo.age - 161;
    }
    
    const activityMultiplier = 1.55;
    const maintenanceCalories = Math.round(bmr * activityMultiplier);
    
    const goal = measurement.currentWeight > basicInfo.targetWeight + 2 ? "loss" : 
                measurement.currentWeight < basicInfo.targetWeight - 2 ? "gain" : "maintain";
    
    let targetCalories;
    if (goal === "loss") {
      targetCalories = maintenanceCalories - 500;
    } else if (goal === "gain") {
      targetCalories = maintenanceCalories + 500;
    } else {
      targetCalories = maintenanceCalories;
    }
    
    logToConsole(`Obliczono zapotrzebowanie: ${maintenanceCalories} kcal/dzieÅ„, cel: ${targetCalories} kcal/dzieÅ„ (${goal})`, 'info');
    
    return {
      maintenance: maintenanceCalories,
      target: targetCalories,
      goal: goal
    };
  }

  // OkreÅ›l kategoriÄ™ BMI
  function getBmiCategory(bmi) {
    if (isNaN(bmi)) {
      logToConsole('NieprawidÅ‚owa wartoÅ›Ä‡ BMI', 'warn');
      return "normal";
    }
    if (bmi < 18.5) return "underweight";
    if (bmi < 25) return "normal";
    if (bmi < 30) return "overweight";
    if (bmi < 35) return "obesity1";
    if (bmi < 40) return "obesity2";
    return "obesity3";
  }

  // Aktualizuj nawigacjÄ™ pomiarÃ³w
  function updateMeasurementNavigation() {
    logToConsole('Aktualizacja nawigacji pomiarÃ³w', 'info');
    const dotsContainer = document.getElementById('measurementDots');
    dotsContainer.innerHTML = '';
    
    if (!userData.measurements || userData.measurements.length <= 1) {
      logToConsole('Brak wystarczajÄ…cej liczby pomiarÃ³w do wyÅ›wietlenia nawigacji', 'info');
      return;
    }
    
    userData.measurements.forEach((measurement, index) => {
      const dot = document.createElement('div');
      dot.className = `dot ${index === userData.currentMeasurementIndex ? 'active' : ''}`;
      dot.title = formatDate(measurement.date);
      dot.addEventListener('click', () => {
        logToConsole(`KlikniÄ™to pomiar z dnia: ${measurement.date}`, 'info');
        userData.currentMeasurementIndex = index;
        updateUI();
      });
      dotsContainer.appendChild(dot);
    });
  }

  // Aktualizuj listÄ™ posiÅ‚kÃ³w
  function updateMealList() {
    logToConsole('Aktualizacja listy posiÅ‚kÃ³w', 'info');
    const mealList = document.getElementById('mealList');
    const mealDots = document.getElementById('mealDots');
    mealList.innerHTML = '';
    mealDots.innerHTML = '';
    
    if (!userData.meals || userData.meals.length === 0) {
      mealList.innerHTML = '<p>Brak dodanych posiÅ‚kÃ³w. Dodaj pierwszy posiÅ‚ek!</p>';
      logToConsole('Brak posiÅ‚kÃ³w do wyÅ›wietlenia', 'info');
      return;
    }

    const currentMeal = userData.meals[userData.currentMealPage];
    
    logToConsole(`WyÅ›wietlam posiÅ‚ek: ${currentMeal.name} (strona ${userData.currentMealPage + 1}/${userData.meals.length})`, 'info');
    
    const mealItem = document.createElement('div');
    mealItem.className = 'meal-item';
    
    const mealHeader = document.createElement('div');
    mealHeader.className = 'meal-header';
    mealHeader.innerHTML = `
      <span class="meal-name">${currentMeal.name} (${mealTypes[currentMeal.type].name || currentMeal.type})</span>
      <span class="meal-calories-value">${currentMeal.totalCalories.toFixed(0)} kcal</span>
    `;
    mealItem.appendChild(mealHeader);
    
    const ingredientsContainer = document.createElement('div');
    currentMeal.ingredients.forEach(ing => {
      const ingItem = document.createElement('div');
      ingItem.className = 'ingredient-item';
      ingItem.innerHTML = `
        <span class="ingredient-name">${ing.emoji || 'ğŸ´'} ${ing.name} (${ing.amount})</span>
        <span class="ingredient-calories">${ing.calories.toFixed(0)} kcal</span>
      `;
      ingredientsContainer.appendChild(ingItem);
    });
    mealItem.appendChild(ingredientsContainer);
    
    mealList.appendChild(mealItem);

    if (userData.meals.length > 1) {
      userData.meals.forEach((meal, index) => {
        const dot = document.createElement('div');
        dot.className = `dot ${index === userData.currentMealPage ? 'active' : ''}`;
        dot.addEventListener('click', () => {
          logToConsole(`KlikniÄ™to posiÅ‚ek: ${meal.name} (indeks ${index})`, 'info');
          userData.currentMealPage = index;
          updateMealList();
        });
        mealDots.appendChild(dot);
      });
    }
  }

  // Aktualizuj plan tygodniowy
  function updateWeeklyPlan() {
    logToConsole('Aktualizacja planu tygodniowego', 'info');
    const weeklyPlanBody = document.getElementById('weeklyPlanBody');
    weeklyPlanBody.innerHTML = '';
    
    if (!userData.measurements || userData.measurements.length === 0) {
      logToConsole('Brak pomiarÃ³w - nie moÅ¼na wygenerowaÄ‡ planu tygodniowego', 'info');
      return;
    }
    
    const currentMeasurement = userData.measurements[userData.currentMeasurementIndex];
    const basicInfo = userData.basicInfo;
    
    if (!currentMeasurement || !basicInfo || !basicInfo.height) {
      logToConsole('Brak wymaganych danych do wygenerowania planu tygodniowego', 'info');
      return;
    }
    
    const currentWeight = currentMeasurement.currentWeight;
    const height = basicInfo.height;
    const targetWeight = basicInfo.targetWeight;
    const weightDiff = currentWeight - targetWeight;
    
    const weeklyWeightLoss = weightDiff > 0 ? 0.8 : -0.5;
    
    for (let i = 1; i <= 4; i++) {
      const weekDate = new Date();
      weekDate.setDate(weekDate.getDate() + i * 7);
      const formattedDate = weekDate.toLocaleDateString('pl-PL', { day: '2-digit', month: '2-digit' });
      
      const projectedWeight = currentWeight - (weeklyWeightLoss * i);
      const projectedBMI = (projectedWeight / ((height/100) ** 2)).toFixed(1);
      const waterIntake = (projectedWeight * 0.03).toFixed(1);
      
      const bmiRounded = Math.round(projectedBMI * 2) / 2;
      const activityRecommendations = detailedActivityRecommendations[bmiRounded] || 
        "Brak szczegÃ³Å‚owych zaleceÅ„ dla tego zakresu BMI";
      
      const row = document.createElement('tr');
      row.innerHTML = `
        <td style="padding: 10px; border-bottom: 1px solid #ddd;">${formattedDate}</td>
        <td style="padding: 10px; border-bottom: 1px solid #ddd;">${projectedWeight.toFixed(1)}</td>
        <td style="padding: 10px; border-bottom: 1px solid #ddd;">${projectedBMI}</td>
        <td style="padding: 10px; border-bottom: 1px solid #ddd;">
          <div style="padding: 5px 0;">${activityRecommendations}</div>
        </td>
        <td style="padding: 10px; border-bottom: 1px solid #ddd;">
          <div class="hydration-info">
            <strong>${waterIntake} L wody/dzieÅ„</strong><br>
            +0,4â€“0,6 L za kaÅ¼de 30 min aktywnoÅ›ci<br>
            +0,7â€“1,0 L za kaÅ¼de 60 min intensywnych aktywnoÅ›ci<br><br>
            ğŸ’¡ <em>Przy aktywnoÅ›ci uzupeÅ‚niaj magnez, wapÅ„, wit. D i elektrolity</em>
          </div>
        </td>
      `;
      weeklyPlanBody.appendChild(row);
    }
    
    logToConsole('Plan tygodniowy zaktualizowany', 'info');
  }
</script>
</body>
</html>
